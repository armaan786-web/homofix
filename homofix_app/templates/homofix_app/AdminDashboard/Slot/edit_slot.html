{% extends 'homofix_app/Base/base.html' %}
{% block main-content %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<div class="page-content">
   <!--breadcrumb-->
   <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
      <div class="breadcrumb-title pe-3"> Slot</div>
      <div class="ps-3">
         <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0 p-0">
               <li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt"></i></a>
               </li>
               <li class="breadcrumb-item active" aria-current="page">Edit Slot</li>
            </ol>
         </nav>
      </div>
   </div>
   <!--end breadcrumb-->
   <div class="card">
      <div class="card-body p-4">
         <h5 class="card-title">Edit Slot</h5>
         <hr>
         <div class="form-body mt-4">
            <form action="" method="POST">
               {% csrf_token %}
               <div class="row">
                  <div class="col-lg-12">
                     <div class="border border-3 p-4 rounded">
                        <div class="mb-3">
                           <label for="inputDateTime" class="form-label">Date</label>
                           <input class="form-control" type="date" name="date" value="{{ slot.date|date:'Y-m-d' }}" required>
                        </div>
                         <div class="mb-3">

                            <label for="inputProductTitle" class="form-label">Slot</label>
                           
                            <select name="slot" id="slotSelect" class="form-control">
                              {% for value, label in slot_choices %}
                                 <option value="{{ value }}" {% if value == slot.slot %}selected{% endif %}>{{ label }}</option>
                              {% endfor %}
                           </select>

                        </div> 

                         <div class="mb-3">
                           <label for="inputProductTitle" class="form-label">State</label>
                           {% comment %} <select class="single-select" name="sub_category_id" id="product-select" multiple >
                              <option class="text-black" value="" selected disabled> --Select--</option>
                          </select> {% endcomment %}
                          <select name="state" id="stateSelect" class="form-control">
                            <option value="">-- Select State --</option>
                            {% for state in unique_states %}
                                <option value="{{ state }}" {% if slot.state == state %}selected{% endif %}>{{ state }}</option>
                            {% endfor %}
                         </select>
                        </div> 
                        
                       
                        

                        

                        
                       
                        <div class="mb-3">
                           <label for="inputDateTime" class="form-label">Pincode</label>
                           
                                    {% comment %} <select class="single-select" name="pincode" id="pincode-select" multiple >
                                        
                                         <option class="text-black" value="" selected disabled> --Select--</option>
                                    </select> {% endcomment %}
                                    <select class="single-select" name="pincode" id="pincode-select" multiple>
                                       <option class="text-black" value="" disabled> --Select--</option>
                                       {% for pincode in state_pincodes %}
                                          <option class="text-black" value="{{ pincode.id }}"
                                                {% if pincode.id in selected_pincode_ids %}selected{% endif %}>
                                                {{ pincode.code }}
                                          </option>
                                       {% endfor %}
                                    </select>

                        </div>
                        <div class="mb-3">
                           <label for="inputDateTime" class="form-label">Subcategory</label>
                           
                                    {% comment %} <select class="single-select" name="subcategory" id="" multiple >
                                        
                                         
                                         {% for sub in subcategory %}
                                         <option value="{{sub.id}}">{{sub.name}}</option>
                                         {% endfor %}
                                    </select> {% endcomment %}
                                    <select class="single-select" name="subcategory" multiple>
                                       {% for sub in subcategory %}
                                          <option value="{{ sub.id }}"
                                                {% if sub.id in selected_subcategory_ids %}selected{% endif %}>
                                                {{ sub.name }}
                                          </option>
                                       {% endfor %}
                                    </select>
                        </div>

                        <div class="mb-3">
                           <label for="slot" class="form-label">Limit</label>
                          
                           <input type="number"  class="form-control" placeholder="Enter Your Limit" value="{{slot.limit}}" name="limit">
                        </div>
                        
                        
                        <input class="btn btn-primary" type="submit" value="submit">
                     </div>
                  </div>
               </div>
               <!--end row-->
            </form>
         </div>
      </div>
   </div>
</div>



{% comment %} <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> {% endcomment %}
<script>
    console.log("Slot modal script loaded...");

    $(document).on('change', '#stateSelect', function () {
        console.log("armaanuuuuu")
        var selectedState = $(this).val();
        $('#pincode-select').empty();

        if (selectedState) {
            $.ajax({
                url: "{% url 'get_pincodes_by_state' %}",
                data: {
                    'state': selectedState
                },
                dataType: 'json',
                success: function (data) {
    var pincodes = data.pincodes;
    $('#pincode-select').empty(); // Clear previous options
    $('#pincode-select').append('<option value="" selected disabled> --Select--</option>');
    
    if (pincodes.length > 0) {
        for (var i = 0; i < pincodes.length; i++) {
            $('#pincode-select').append(
                '<option value="' + pincodes[i].id + '">' + pincodes[i].code + '</option>'
            );
        }
    } else {
        $('#pincode-select').append('<option value="">No pincodes found</option>');
    }
}

            });
        }
    });
</script>


 

{% endblock main-content %}